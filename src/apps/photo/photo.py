from api.base import Base
from rgbmatrix import FrameCanvas

from PIL import Image
from io import BytesIO
from base64 import b64decode
from os import getenv


DEFAULT_IMAGE = "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"


class Photo(Base):
    def __init__(self, canvas: FrameCanvas):
        super().__init__(canvas)
        self.image = (
            Image.open(
                BytesIO(
                    b64decode(getenv("Photo_PHOTO", default=DEFAULT_IMAGE).encode())
                )
            )
            .convert("RGB")
            .resize((64, 32))
        )

    def run(self) -> bool:
        self.canvas.SetImage(self.image, 0, 0)

        self.sleep(15 * 1000)
        return True

    @staticmethod
    def env() -> bool:
        return True

    @staticmethod
    def variables() -> list:
        return ["PHOTO"]
